import { getRedis } from './_kv.mjs'
export default async function handler(req,res){res.setHeader('Access-Control-Allow-Origin','*');res.setHeader('Content-Type','application/json');const r=getRedis();const key='matches';if(req.method==='GET')return res.json((await r.get(key))||[]);if(req.method==='POST'){const b=JSON.parse(req.body||'{}');let list=(await r.get(key))||[];if(b.action==='add')list.unshift(b.payload);if(b.action==='clear')list=[];await r.set(key,list);return res.json({ok:true})}}